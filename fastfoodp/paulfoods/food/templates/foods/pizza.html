<!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>{% block title %}PERFIL {%endblock%}</title>
        
            <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <link rel="icon" href="https://www.flaticon.es/svg/vstatic/svg/3916/3916657.svg?token=exp=1662854069~hmac=136bd71682904cb823525cd8938961b9">
        {% load static %}
        <style>
          .profile-image {
            width: 300px; /* Ancho de la imagen de perfil */
            height: 300px; /* Altura de la imagen de perfil */
            border-radius: 50%; /* Redondea las esquinas para hacer una imagen circular */
            border: 4px solid  #0e8056; /* Agrega un borde blanco a la imagen de perfil */
            margin-bottom: 20px; /* Agrega un espacio entre la imagen de perfil y otros elementos */
        }
          
        .user-data {
          margin-bottom: 20px; /* Agrega un espacio entre los datos del usuario y otros elementos */
      }
        
          .navbar-light .navbar-nav .nav-link {
            color: BLACK;
          }
      body {
        background-image: url('https://img.freepik.com/foto-gratis/concreto-texturado-blanco_125540-1826.jpg?w=996&t=st=1708584169~exp=1708584769~hmac=6802f37a96b71f7b953580787dab6c7cf1f21b681cf0d8a35082798e77006d33');
        background-size: cover;
        background-position: center center;
        background-attachment: fixed;
    }
      body {
        font-family: "Centra No2", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    
        }
  
      .form-inline .btn-success {
          background-color: #28a745;
          border-color: #28a745;
          color: white;
      }
     
      .btn-info {
        color: #fff;
         background-color: #0fd28a;
        border-color: #80ae90;
        margin: 5px;
  padding:10px;
  -webkit-border-radius: 50px;
  -moz-border-radius: 50px;
  border-radius: 50px;
  font-size:18px;
  line-height:32px;
  
  
      }p{
        border: 2px solid #a6aaa6;
        padding:20px;
        background-color: #776e6e2b;
  }
      .form-inline .btn-success:hover {
          background-color: #218838; /* Color de resaltado al pasar el rat√≥n */
          border-color: #1e7e34;
      }
  
      .navbar-brand img {
          border: 2px solid white;
          border-radius: 50%;
      }
      .product-card {
        border: 1px solid #ccc;
        padding: 15px;
        margin-bottom: 20px;
    }
    
      .ar {
        color: #fff;
        text-decoration: none;
        background-color: #bca52cfc;
      }
      .bg-dark {
          background-color: #2a3b26;
      }
     
    
    /* Keep your existing styles below this line */
   
      .navbar-nav .nav-link {
          color: white;
     
      }
  
      .navbar-nav .nav-link:hover {
        text-decoration: underline;
        font-weight:bold;
      }
  
      .CARRT {
          padding: 15px;
          margin-top: 20px;
      }
  
      .navbar-text {
          color: black;
        
      }
  
      .navbar-nav {
          margin-right: 10px;
      }
  
      * {
          margin: 0;
          box-sizing: border-box;
      }
  
      .navbar-text {
          margin-right: 10px;
      }
  
      .navbar-expand-sm {
          -ms-flex-flow: row nowrap;
          flex-flow: initial;
          -ms-flex-pack: start;
          justify-content: center;
      }
  
      .container {
          margin-top: 20px;
      }
  
      .form-inline {
          margin-bottom: 20px;
      }
      .w-100 {
        width: 100% !important;
      }
      .card {
          background-color: white;
          margin-bottom: 20px;
          
          border: 2px solid #b5b3b3;
          display: inline-table;
      }
  
      .picture {
          width: 100%;
          height: auto;
          max-width: 400px;
          margin: 10px 0;
      }
  
      .btn-info {
          margin-top: 10px;
      }
  
      .carr {
          font-family: "Lucida Console", "Courier New", monospace;
      }
  
      .perr {
          padding: 177px;
      }
  
      .cartc {
        background-color: #bfac46;
          color: black;
          font-family: "Lucida Console", "Courier New", monospace;
      }
        a{
          color: #0e8056;
        }

        /* === removing default button style ===*/
.button {
  margin: 0;
  height: auto;
  background: transparent;
  padding: 0;
  border: none;
  cursor: pointer;
}

/* button styling */
.button {
  --border-right: 6px;
  --text-stroke-color: rgba(255,255,255,0.6);
  --animation-color: #37FF8B;
  --fs-size: 2em;
  letter-spacing: 3px;
  text-decoration: none;
  font-size: var(--fs-size);
  font-family: "Arial";
  position: relative;
  text-transform: uppercase;
  color: transparent;
  -webkit-text-stroke: 1px var(--text-stroke-color);
}
/* this is the text, when you hover on button */
.hover-text {
  position: absolute;
  box-sizing: border-box;
  content: attr(data-text);
  color: var(--animation-color);
  width: 0%;
  inset: 0;
  border-right: var(--border-right) solid var(--animation-color);
  overflow: hidden;
  transition: 0.5s;
  -webkit-text-stroke: 1px var(--animation-color);
}
/* hover */
.button:hover .hover-text {
  width: 100%;
  filter: drop-shadow(0 0 23px var(--animation-color))
}
    
        </style>
        </head>
        <body>
          <nav class="navbar navbar-expand-sm bg-light navbar-light">
            <!-- Brand/logo -->
            <a class="navbar-brand" href="#">
              <button class="button" data-text="Awesome">
                <span style="color:black;" class="actual-text">&nbsp;EXTREMETRAVEL&nbsp;</span>
                <span aria-hidden="true" class="hover-text">&nbsp;EXTREMETRAVEL&nbsp;</span>
            </button>
            </a>
            
            <!-- Links -->
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link {% if active_link == 'index' %} active{% endif %}" href="{% url 'index' %}">HOME</a>
              </li>
              {%if user.is_authenticated%}
              <li class="nav-item">
                <a class="nav-link {% if active_link == 'chicken' %} active{% endif %}" href="{% url 'food:actividad' %}">DEPORTES EXTREMOS</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="{% url 'food:steak' %}">TOURS</a>
              </li>
              {%else%}
              <li class="nav-item">
                <a class="nav-link {% if active_link == 'actividad' %} active{% endif %}" href="{% url 'food:login' %}">LOGGEATE PARA VER LOS VIAJES</a>
              </li>
              {%endif%}
              <li class="nav-item">
                <a class="nav-link" href="{% url 'food:burger' %}">MAPA</a>
              </li>
              
              <li class="nav-item">
                <a class="nav-link" href="{% url 'food:drink' %}">UBICACIONES</a>
              </li>
        
              <li class="nav-item">
                <a class="nav-link {% if active_link == 'pizza' %} active{% endif %}" href="{% url 'food:perfil' %}">PERFIL</a>
              </li>
               {% if user.is_authenticated %}
                <li class="nav-item">
                    <span class="navbar-text">DE {{ user.username }}</span>
                </li><li class="nav-item">
                <a href="{% url 'food:ver_carrito_y_pagar' %}" class="nav-link {% if active_link == 'index' %}active {% endif %}">
                    <img srcset="https://img.icons8.com/small/344/add-shopping-cart.png 2x" alt="icon" loading="lazy" style="width: 30px; height: 30px; filter: invert(0%) sepia(9%) saturate(7465%) hue-rotate(38deg) brightness(112%) contrast(97%);"/>
                    
                </a>
              </li>
                {% endif %}
              
              {% if user.is_authenticated %}
              <li class="nav-item">
                <a href="{% url 'food:logout' %}" class="nav-link">
                  <img class="bg-light rounded-circle" srcset="{{user.profile_image_url}}"  style="width: 40px; height: 40px;"/>
                    LogOut
                </a>
              </li>
        
                <ul>
             
              {% else %}
              <li class="nav-item">
                <a href="{% url 'food:login' %}" class="nav-link {% if active_link == 'index' %}active {% endif %}">
                    <img class="bg-light rounded-circle" srcset="https://img.icons8.com/external-bearicons-glyph-bearicons/344/external-log-in-call-to-action-bearicons-glyph-bearicons-1.png 2x" alt="icon" loading="lazy" style="width: 30px; height: 30px; filter: invert(0%) sepia(0%) saturate(0%) hue-rotate(102deg) brightness(99%) contrast(104%);"/>
                    LogIn
                </a>
              </li> <li class="nav-item">
                <a href="{% url 'food:signup' %}" class="nav-link {% if active_link == 'signup' %}active {% endif %}">
                    <img class="bg-light rounded-circle" srcset="https://img.icons8.com/external-bearicons-glyph-bearicons/344/external-log-in-call-to-action-bearicons-glyph-bearicons-1.png 2x" alt="icon" loading="lazy" style="width: 30px; height: 30px; filter: invert(0%) sepia(0%) saturate(0%) hue-rotate(102deg) brightness(99%) contrast(104%);"/>
                    Create account
                </a>
              </li>
              {% endif %}
            </ul> 
            
          </nav><center>
          <div>
            {% block content %}
            <br><br><br>
            <div class="col-md-6 p-4 card" style="color:black">
  <h1 style="color:#0fd28a;"><B>PERFIL DEL USUARIO</b></h1><br>
  

    {% if user.is_authenticated %}
    <center><br><br><div style="display: flex;">
      <!-- Imagen de usuario -->
      <div style="flex: 2;">
          <img class="profile-image" src="{{ user.profile_image_url }}" alt="SIN IMAGEN DE PERFIL"><br>
          <p>{{puntos}}</p>
      </div>
      <!-- Datos del usuario -->
      <div style="flex: 2; padding-left: 20px; text-align: center;">
          <p class="rounded"><strong>Bienvenido {{ user.username }}</strong></p>
          <p class="rounded"><strong>Nombre:</strong> {{ user.first_name }} {{ user.last_name }}</p>
          <p class="rounded"><strong>Email:</strong> {{ user.email }}</p>
          <p class="rounded"><strong>Tel√©fono:</strong> {{ user.phone_number }}</p>
          <p class="rounded"><strong>Direcci√≥n:</strong> {{ user.direccion }}</p>
          <p class="rounded"><img class="bg-light rounded" src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Flag_of_Mexico.svg/2560px-Flag_of_Mexico.svg.png" alt="" style="width:60px;"><strong> Estado:</strong> {{ user.estado }}</p><br>
          <p class="rounded"><strong>Cuenta creada el:</strong> {{ user.date_joined }}</p>
      </div>
      
      
        
  </div>
  <br><br>
  <button id="editProfileBtn" class="btn btn-info"><b>Editar Perfil</b></button>
      <div id="editFormContainer"></div>
      <script>
        let editFormVisible = false;
        
        document.getElementById('editProfileBtn').addEventListener('click', function() {
            if (!editFormVisible) {
                // Realiza una petici√≥n AJAX para obtener el formulario de edici√≥n
                fetch("{% url 'food:editar_usuario' user.id %}")
                    .then(response => response.text())
                    .then(data => {
                        // Coloca el formulario en el contenedor
                        document.getElementById('editFormContainer').innerHTML = data;
                        editFormVisible = true;
                    });
            } else {
                // Oculta el formulario si ya est√° visible
                document.getElementById('editFormContainer').innerHTML = '';
                editFormVisible = false;
            }
        });
        
        // Manejar el env√≠o del formulario de edici√≥n mediante AJAX
        document.addEventListener('submit', function(event) {
          if (event.target.matches('#editProfileForm')) {
              event.preventDefault(); // Evita que el formulario se env√≠e normalmente
      
              // Obtiene el token CSRF del formulario
              const csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;
      
              // Realiza una petici√≥n AJAX para enviar los datos del formulario
              fetch(event.target.action, {
                  method: 'POST',
                  body: new FormData(event.target),
                  headers: {
                      'X-Requested-With': 'XMLHttpRequest', // Indica que es una solicitud AJAX
                      'X-CSRFToken': csrfToken // Agrega el token CSRF como un encabezado
                  }
              })
              .then(response => {
                  if (response.ok) {
                      // Recarga la p√°gina despu√©s de guardar los cambios
                      window.location.reload();
                  } else {
                      // Maneja errores si es necesario
                  }
              });
          }
      });
        </script>
        
  {% else %}
  <!-- Mensaje para usuarios no autenticados -->
  <li class="nav-item">
      <a href="{% url 'food:login' %}" class="nav-link {% if active_link == 'index' %}active {% endif %}">
          <img class="bg-light rounded-circle" srcset="https://img.icons8.com/external-bearicons-glyph-bearicons/344/external-log-in-call-to-action-bearicons-glyph-bearicons-1.png 2x" alt="icon" loading="lazy" style="width: 30px; height: 30px; filter: invert(0%) sepia(0%) saturate(0%) hue-rotate(102deg) brightness(99%) contrast(104%);"/>
          Inicia sesi√≥n para ver tu perfil
      </a>
  </li>
  <li class="nav-item">
      <a href="{% url 'food:signup' %}" class="nav-link {% if active_link == 'signup' %}active {% endif %}">
          <img class="bg-light rounded-circle" srcset="https://img.icons8.com/external-bearicons-glyph-bearicons/344/external-log-in-call-to-action-bearicons-glyph-bearicons-1.png 2x" alt="icon" loading="lazy" style="width: 30px; height: 30px; filter: invert(0%) sepia(0%) saturate(0%) hue-rotate(102deg) brightness(99%) contrast(104%);"/>
          Crea una cuenta nueva y √∫nete
      </a>
  </li>
  {% endif %}
  <br><br><br><br>
  <h2><b>User Orders</b></h2>
  {% if user.is_authenticated %}
  <table class="table table-bordered"> 
    <thead>
        <tr>
            <th>Producto</th>
            <th>Precio</th>
            <th>Cantidad</th>
        </tr>
    </thead>
    <tbody>
        {% for item in items_carrito %}
        <tr>
            <td>- {{ item.pollo.name }}</td>
            <td>${{ item.pollo.priceM }}</td>
            <td>{{ item.cantidad }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="3">No hay productos en el carrito</td>
        </tr>
        {% endfor %}
    </tbody>
</table>{%endif%}
</div>

{% endblock %}
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    
<!-- Latest compiled JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>



        </body><footer class="bg-dark text-white p-4">
  <div class="container">
      <div class="row">
          <div class="col-md-4">
              <h4>Contacto</h4>
              <p><i class="fas fa-map-marker-alt"></i> Direcci√≥n: Ciudad, Pa√≠s</p>
              <p><i class="fas fa-envelope"></i> Correo: info@extremetravel.com</p>
              <p><i class="fas fa-phone"></i> Tel√©fono: +123 456 7890</p>
          </div>
          <div class="col-md-4">
              <h4>Enlaces √∫tiles</h4>
              <ul class="list-unstyled">
                  <li><a href="#">Inicio</a></li>
                  <li><a href="#">Destinos</a></li>
                  <li><a href="#">Tours</a></li>
                  <li><a href="#">Rese√±as</a></li>
              </ul>
          </div>
          <div class="col-md-4">
              <h4>S√≠guenos</h4>
              <p>Con√©ctate con nosotros en redes sociales:</p>
              <a href="#" class="btn btn-outline-light"><i class="fab fa-facebook-f"></i></a>
              <a href="#" class="btn btn-outline-light"><i class="fab fa-twitter"></i></a>
              <a href="#" class="btn btn-outline-light"><i class="fab fa-instagram"></i></a>
          </div>
      </div>
  </div>
</footer>
        </html>
